# ->23783
import csv

diseases = ['4019', '4280', '42731', '41401', '5849', '25000', '2724', '51881', '5990', '53081', '2720', 'V053', 'V290', '2859', '2449', '486', '2851', '2762', '496', '99592', 'V5861', '0389', '5070', 'V3000', '5859', '311', '40390', '3051', '412', '2875', 'V4581', '41071', '2761', '4240', 'V1582', 'V3001', '5119', 'V4582', '40391', '78552', '4241', 'V5867', '42789', '32723', '9971', '5845', '2760', '7742', '49390', '2767', '5180', '4168', '45829', '2749', '4589', 'V502', '73300', '78039', '5856', '4271', '4254', '4111', 'V1251', '3572', '30000', '99811', '27800', 'E8798', '41400', '60000', '7907', '2930', '00845', '2768', '4439', '5789', 'V4501', '27651', '28521', '27652', '431', '4275', 'E8788', 'V4986', '769', '79902', '70703', '5715', 'V103', '99591', '2639', '42832', '99812', '42833', '07054', '42732', 'E8782', 'V1046', '5712', '49121', '99859', '2809', '27801', '78551', '42823', '25060', '2948', '3004', '4139', '42822', '28529', 'V1254', '5601', '570', '78791', '77081', 'E8497', 'V667', '78820', '2869', '2800', '5723', 'V3101', 'E8889', '79092', '2763', '78959', '3485', '34590', '30500', '5770', '25040', '99662', '9982', '76518', 'V5865', '71590', '76527', '36201', '76528', '4148', '41519', '28860', '56210', '1985', '43310', '56400', 'V4365', '29181', 'V4364', '42830', '1977', '48241', '5121', '3970', 'V1005', '1983', '51882', '1970', '7706', '49320', '76519', '5853', 'V4502', '6826', '43491', '30391', '3659', '3484', 'E8781', 'E8859', 'V173', '04111', 'V153', '51889', '33829', '5781', 'E9342', '51884', '5939', 'V433', '07070', '34830', '7455', '5722', '5533', '5761', '4414', '7746', 'V090', '430', '7140', '1120', 'V1581', '34982', '43411', '4928', '04104', '29410', '7850', '77981', '29680', '30390', 'V4511', '58381', '77089', '78057', 'V440', '78009', '3314', '99674', '41041', '3310', '42741', '99731', 'E9331', 'E9320', 'E8809', '515', '41011', '6930', '042', '2764', '78559', '51919', 'V707', '4260', '34690', 'V441', 'V1011', '03811', '99681', '5363', 'V1083', '3320', '2536', '45981', '78720', '5570', 'V4589', '42821', '4412', '7843', '76526', '7242', '34290', 'V422', '41402', '76517', '0413', '99672', '03842', '2867', '43889', 'E8790', 'V462', '77989', '2753', '25002', '4011', 'V293', '3481', '2866', '9975', '25080', '25050', '4239', '53550', 'V1082', '70715', '19889', '39891', '43820', '44020', '70722', 'V1052', '7904', '3569', '7802', '42831', '5771', '4821', 'E8780', '5780', '25061', '25013', '99702', '73390', '45621', '42820', '591', '4373', 'V8741', '7661', '7766', '7470', '86121', '0417', '30560', '5680', '4160', '30501', '03849', '6822', '4321', '1628', '72888', '42781', '3962', '70714', '4210', '85221', '27541', 'V1588', '30301', '0380', '8600', 'E8498', 'E8490', '8730', '29281', '5762', '7291', '7756', '7245', '27669', '76516', '28522', '41091', '45620', '57420', '5724', '3963', 'V1051', '20280', '79029', '1122', '1550', 'V420', '53789', '56212', '1623', '5854', '56409', '27650', 'V08', '45341', '51883', '7100', '42843', '44024', 'E9478', '25041', '2113', '25001', '1976', '60001', '7464', '70705', '8054', '5711', '30393', 'V1259', '340', '5184', '8052', '78052', 'E8786', '7847', '53085', '2910', '73313', '185', '04185', '49322', '79001', '76515', '78830', '78060', '70707', '04119', '78701', 'V1272', '4142', '07032', 'E9289', '7885', '30981', '6961', '4580', '87342', '4263', '25051', '71690', '76525', '4400', 'V4975', '5768', '99931', '30401', '34839', 'V5866', '41072', '4588', '34831', '7823', '7840', '5559', '5718', '725', '53240', 'V600', '5609', '9972', '53140', 'E8120', '2752', '25063', '43330', '44023', '48283', '8082', '452', '44021', '7821', '27542', '135', '1961', '78659', '7994', '1962', '2662', '3453', '29590', '3441', 'E8147', '8024', '33394', '5569', '85220', '28800', '3694', '8020', '43811', '78097', 'V3401', '04112', '56722', '56211', '5641', 'E9308', 'E8160', '4233', '99832', '4401', '44101', '56081', '8028', 'V1301', '56983', 'V4586', 'V454', 'E9352', '4829', 'V4987', '4820', '3899', 'V4579', '59654', '72989', '77181', '36250', '2252', '1890', 'V443', '7852', '1972', '99664', '6823', '59970', '25541', '99673', '99659', '7856', '76514', '53019', '0416', 'E915', '7921', '4550', 'V4611', 'E8792', '78829', '99889', '29570', '23871', 'V442', '9654', '2967', '0388', '5920', '41189', '25011', '261', 'E9503', '04186', '2440', '56881', '9331', '44422', 'V641', '5772', '45182', 'E8796', '25012', '53010', '5728', '23875', '41511', '25062', '7210', 'V4573', '78061', '4370', '5303', '920', '20500', '78194', '8670', '481', '78550', '9999', '30590', '76524', 'V180', 'V1204', '5307', '4940', '04149', '8080', '5589', '5109', '5531', '72400', '80701', '7454', '4568', '71536', '49392', '70709', '56089', '2518', '6827', '56723', 'E8495', 'E912', 'V0980', '25043', '7707', '20410', '7905', '30550', '20300', 'E8700', '319', 'V4983', 'E9500', '4242', '7750', '59971', '28981', '78321', '42842', '51189', 'E8791', '99682', 'V1087', '9992', '72402', '5750', '1629', '07044', '7812', '7837', '51851', '3383', '36221', '07030', '40301', '4010', '1125', '56981', '2920', 'V5869', 'V3100', '9694', '1991', '25053', '58881', '57410', '1625', '4264', '78609', '29420', 'V1006', '73730', '7824', '57451', 'V1271', '48242', '29620', '4270', '4592', 'V1042', '8056', '53190', '99831', '81000', '5738', '2819', '80709', '78079', '3669', '7906', 'V0254', '4430', 'E9394', '514', '29040', '9961', 'V8801', '3079', '55321', 'V4572', '53560', '80502', '6929', '51902', '2689', '78001', '7213', '03819', '53390', '42090', 'E9504', '53551', '4739', '71941', '77082', '70723', '8026', '78062', 'V1302', 'V6441', '2410', '4786', 'E8499', '99661', '5733', '99685', 'V427', '04109', '7078', 'E8844', '33818', '41001', '28850', 'V1255', '4423', '85201', '72889', '9951', 'E9359', '82021', '5579', '31401', '41031', '4299', '78900', 'V453', '8604', 'V5331', 'V6284', '27739', '28419', '0088', '76503', '2738', '7783', '3371', '79431', '70719', '9341', '1978', '7295', '45342', '1987', '2630', '42611', '1179', '7755', 'V452', '28749', '9986', '99739', '3241', '42613', 'E8150', '86803', '5852', '59010', '71596', '51181', '4471', '78451', '34889', '56969', '2939', '25042', '80703', '1123', '9584', '56729', '5793', '1570', 'V550', '03843', '43311', '53783', '3558', '4660', '55090', '28803', '11284', '5571', '34400', '78722', '80702', '78702', 'E9444', '4561', '40310', '3331', '51909', '2512', '86405', 'V850', '25070', '70721', '45821', '78650', '70724', '7854', '30001', '45381', '70712', 'E8849', '80126', '87343', '03812', '28959', '99594', 'V4571', 'V1079', '7702', 'V160', '57511', '501', '2883', 'E9300', '30503', '41021', '25082', '4590', '70720', '1173', '73028', '53540', '3968', '0549', '70725', '99749', '76502', '99709', 'V113', '3363', '2384', '45184', '72887', '5921', 'E9420', '2989', '11289', '77211', '24290', '7580', '2721', 'V4976', '0383', '42840', 'V1201', '99881', '76523', 'E9305', '5168', '53541', '3559', 'E9429', 'E8810', '73008', '5932', '6910', '73007', '24900', '57400', 'V1041', 'E8783', '48282', 'V4972', '85226', '57450', '2769', '5778', '30400', 'E9290', 'V0259', '1960', '5693', '85200', '8072', '80507', '4552', 'E9479', '1974', '4404', '25200', '44489', 'V1043', '1121', '7784', '9092', 'V1003', '80704', '27803', '70713', 'V1009', '7810', '28731', '27401', '33182', 'V1021', '7757', 'V1209', '80708', 'E8122', '1510', '56985', '8602', '42989', '28984', '52100', '99883', '5790', 'E9426', 'V5332', '4659', 'E8799', 'V1253', '30520', '86500', '5720', '4359', '85206', '5178', '45340', '37230', '73679', '5855', '7804', '4822', '81100', '5679', '07051', '55320', '74602', '72210', '2411', '75733', '0785', '1984', '80121', 'V642', '36846', '1508', '53290', 'V1551', '25081', '1578', '7813', 'V1749', '34510', 'E8121', '8910', '2535', '44103', '44022', '4230', '75329', '0382', '3229', 'V5883', '7211', '7243', '43882', 'V1584', '56721', '4295', '72886', 'V163', '1363', '7318', '5370', '7948', '72992', '29650', '5130', '5695', 'V4283', '53082', '25052', '4238', '86804', 'E9379', '59080', 'V8541', 'V202', '5839', '7231', '7786', 'V463', 'E8708', '85222', '59381', '2888', 'E882', '34292', '317', 'E9323', '40291', 'V444', '20190', '42769', '7230', '1830', '56889', '43883', '99813', '7135', '30300', '04102', '7101', '41412', '9693', '4870', '4169', '4422', '82101', '7761', '2111', 'V851', '51852', '73710', '4532', '07999', '9100', '2731', '85202', '73027', '5602', '45382', '9349', '7892', '30561', '3510', '28249', '30183', '30421', '7866', '7820', '4413', '8074', '99669', '2441', '2532', 'E8784', '4329', 'V1279', '2409', '36960', '1975', '4255', '71535', '2189', '70704', '9587', '7862', '35800', '81342', 'E8881', '47831', '72981', '29690', '78729', '53200', '9351', '5730', '41081', '80705', '7726', '56989', '7963', '9916', '0539', '42841', '138', '1622', '34291', '1748', 'V4282', '8208', '55221', 'E9361', 'E966', '5110', '1551', 'E9358', '6960', '24200', '71946', '3003', '04189', '80501', '99762', '99667', '71945', '75312', '25092', '2839', '9072', '44102', 'V071', 'V446', '7716', '1888', 'V4281', '4293', '1911', 'V1007', '3332', '78065', '85181', '7842', 'V140', '4389', '2811', '2858', '4556', '07071', '7788', '80122', '4553', '9070', '7098', '96509', '5934', '73017', '76719', '58281', '80506', 'E9600', '4571', 'V298', '9950', 'E8502', 'E8842', '3439', '4417', 'V1072', '53642', '20510', '6989', '36900', 'E9378', '80706', '4379', '71106', '27549', '3379', '72252', 'V551', '99593', '4372', 'V4561', '29530', '44421', '60784', '74781', '60886', '39890', '9348', '82300', '7700', '4408', '7991', '72293', '79311', 'E8261', '85301', '82009', '7102', 'V161', '72973', 'E9288', '78909', 'E8504', '2270', '2810', '53100', 'E8230', '5100', '73018', '47829', '262', '99649', '47874', '3361', '7424', '03840', '82022', '43401', '76408', '28489', '53020', '99601', 'V553', '85186', '3313', '80841', '49122', 'E9363', 'V4585', '99679', 'V1002', '485', '4846', 'E9310', '1505', '29562', '34550', '6824', '25083', '1749', '2830', '8248', '2825', '4558', '3501', '04110', '56949', 'V4588', '37272', '71906', '7919', '42983', '75251', '29689', '5716', '40300', '53021', '34200', '4465', '71595', '87363', '1971', '42091', '73342', '44381', '5225', '75261', 'E8532', '1912', '5848', '78603', '99604', '5181', '3540', '2949', '4619', '4162', '78951', 'E9293', '99602', 'E8161', 'V1552', '3941', '3942', '99666', '78606', '74689', '5305', 'V552', '72190', '5779', '4871', '73382', '57491', '7717', '33819', '44481', '6202', '4259', '41092', '53782', 'E9689', 'E8888', 'V1004', '7530', '3682', '04184', 'V1089', '4464', '2900', '3960', '30540', '80120', '80505', '3480', '4232', '82525', '1963', '29630', '56982', '56039', '7861', '43331', '4476', 'E8162', 'V8543', '87344', '56941', '53784', '9800', '49120', '3240', '78093', '57142', '80101', '52801', '86602', '193', '76407', '3090', '7200', '2273', '44031', '3518', '99671', '34540', '2853', '80600', '53561', '1919', 'E9309', '58889', '86503', '25010', '77083', '7384', '35801', '9663', '5192', '25201', '2774', '4578', '85180', '99779', '42682', '7731', '4779', '35981', '30551', 'E9398', '78901', '7830', '99663', '81002', '3384', '34580', '58089', '41051', '44329', '2112', 'V1047', '05319', '7220', '9160', '30563', '27900', '42971', '99769', '78906', '55092', '85225', 'E9348', '44321', '7310', '3594', '42612', '81344', 'E8543', '31400', '44284', 'V4577', '4258', '1973', '75989', '53510', '6238', '33520', '85300', '41512', '5710', 'V1351', '2713', 'E9424', '1552', 'V5811', '4785', '5960', '19882', 'V8542', '25022', 'E9421', '80125', '4549', '4919', '80707', '566', '6821', 'E956', '42490', '85011', '76383', '03810', '76529', 'E8136', '76522', '78630', '53649', '4555', '1541', '41410', '29532', '99932', '3688', 'E9509', '96500', '43320', 'V151', '4920', 'E8843', '5566', '7868', '9630', '33811', '6851', '37854', '68110', '5194', '5300', '2127', 'V1541', '1981', '82332', '53089', '7503', '3239', 'E8190', '43813', 'E9413', '30470', 'E9393', '7625', 'V1085', '86389', '22804', '42099', '85205', '2899', '81341', '1561', '5289', '79579', '86509', '1913', '86502', '8708', '85182', '96501', '70706', '99590', '71598', '77183', '38600', 'E9179', '6820', '8505', '7732', '53501', 'V643', '3576', '70702', '92400', '82302', '20400', '78605', 'E911', '44324', '56962', '4466', '4110', '3575', '3570', '490', '72972', '1982', '1103', '0415', '5989', '72271', '40311', '81201', '9962', '80508', '73319', '78841', '73399', '73309', '30471', '8240', '42652', '45386', '1536', '80504', 'E9800', '4941', 'E9383', '69589', '45189', 'E8583', '5368', 'E8706', '7873', '27730', '80605', '8820', '2572', '5183', '7533', '85306', '47830', '5272', '1124', '9588', '4441', '4231', '5224', 'V5419', '8244', '04101', '1101', '73819', 'V554', '1918', '6953', '70710', '1533', '9222', 'V270', '7962', '57510', 'E8785', 'E9682', '1579', '29572', '37430', '95901', 'V4973', '41061', '7483', 'V148', '1980', '78652', '5650', '30928', '95892', '34489', '72610', '29411', '53440', '27503', '5198', '78907', '5373', '38611', '57512', '3668', '86402', '1624', '22801', '30420', 'E8794', '5758', '5739', '7197', '5306', '30591', 'E9353', '43301', '2631', '81209', '56731', '2114', '6191', '40491', '2511', '56789', 'E9390', '81221', '1968', '8220', '44322', '52800', '5523', 'V4576', '82123', '78459', '4352', '5583', '37941', '449', 'E887', '462', '78099', '5379', '25071', '8748', '7801', '8738', '76405', '3490', '29212', '6146', '4560', '29041', '2860', 'E916', '27952', '1889', '33399', '76621', '3330', '57149', '7778', '7423', '59972', '2452', '25020', '92232', '49300', '9212', '71696', '79093', '7452', '5552', '78721', '5550', '0542', '72885', '9726', '28989', '86501', '7244', 'V1000', '96502', '59389', '41404', '37851', '77210', '86504', '49391', '99791', '1538', '33812', '7767', '7790', '2863', '7818', '3599', '1539', '80843', '99989', '25072', 'V5413', '87320', '5881', '22809', '605', '78703', '86403', '99686', '45385', '5950', '9181', '7048', '56984', '3940', '7313', '53012', '8470', '56213', '9190', '7764', '3099', '61610', '43819', '56200', 'E9317', '6262', '88100', '71101', '7469', '9651', '99676', '1534', '5304', '20501', '27788', '78839', '71105', '43490', '2375', '30410', '42610', '99665', '75982', '2559', '53011', '2890', '56738', '45384', '86415', '9130', '8620', '85302', '34591', '81109', '4257', '36816', '7660', 'V6442', '4470', '6084', '0479', '28319', 'V0382', '7881', '85305', '41012', '48284', '30553', '4358', '3489', '2733', '30411', '8064', 'E9010', '5933', '20020', '8911', '1105', '9010', '3829', '4380', '1509', '87340', '34570', '5829', '41042', '42689', '61172', '5400', '9221', '80620', '60883', '75501', '80106', '4472', '5120', '7630', '81003', '30502', '5819', 'E8846', '87341', '2555', '45989', '81601', '82382', '53641', '80220', '74710', '72291', 'V0981', '5111', '3203', '1820', '03844', '5283', '05410', '2448', '29633', '8250', '30570', '5880', '74783', '05479', '87364', '4387', '1518', '30029', '75310', '6954', '70711', 'E9392', '7224', 'E9384', '74190', '86401', '99701', '71947', '4599', '30392', '78442', '5691', '30593', '32082', '40493', '7234', '2521', '80026', '5258', '88101', '0090', '3209', '30521', '2864', '42761', 'E8192', '73739', 'V1202', '76406', '3369', '5961', '3950', '1560', '5551', '2732', '7080', '04100', 'E9804', '4411', 'V4962', '3102', '2710', '3181', '9623', 'V1044', 'V1001', 'E8496', '5081', '57431', '7795', '2788', '8700', '220', '83500', 'E9299', '80021', '22802', '86404', 'E9298', 'E9356', '3017', '8830', '34460', 'V5863', 'E9650', '1965', '6828', '34931', '86601', '5521', '2651', '56961', '04082', 'V0991', '43822', '64421', '59960', '37200', '5374', '53530', '75679', '77982', 'V5812', '7099', '78639', '20288', '87349', '99851', '4267', '75732', '45351', '71591', '92410', '34280', '92411', 'E8493', '3071', '81200', '76513', '30403', 'V4361', 'E9654', 'V632', '2638', '23879', '34680', '4474', '82111', '86801', '9340', '5754', '36570', '7596', 'V168', 'E9319', 'V5862', '8260', '6271', '5798', '99939', '25003', '80100', '8750', '5713', '59582', '9678', '3009', '3315', 'V8536', '78469', '44629', '82301', 'E9803', 'V6549', '8242', '9054', '73314', 'E9530', '08881', '86229', '7910', '9698', '77212', '77213', '1104', '29624', '52809', '4281', '6825', '43321', '80609', '79094', '48240', '53170', '80625', '53084', '71965', '58389', '4809', '38589', '82392', '44281', '42653', '20210', '6959', '59969', '34541', '7515', '7827', '3019', '5959', '70701', '45383', '325', '7104', '47875', '80102', '57471', '2911', '6256', 'V556', '6983', '7511', '8605', '1562', 'V171', '78821', 'E8704', '1966', '47824', '44389', '436', '51901', '2690', '81500', '34202', 'E8494', '78831', '20200', '64891', '5935', '36281', '55010', '5734', '5528', '8900', '55329', '99799', '4536', '7512', 'E8191', '4294', '2537', '4738', '81301', '99809', '34511', '96909', '90089', '28804', '2971', '74685', '27400', 'V4984', '43821', '59651', '36202', '53250', 'V5489', '07020', '8601', '57461', '66612', '48249', '78904', '78003', '2894', '5401', '81220', 'V4971', '5362', '64824', '57490', 'V4512', '9110', '33385', '80604', '0543', '2181', '2550', '86813', '99631', 'E8500', '1129', '1504', '76409', '7703']



drugs = ['00338001702', '00338004904', '00338004903', '00409672924', '00517570425', '51079025520', '00338004902', '00338070341', '00338355248', '00338004938', '00338011704', '00456066270', '63323026201', '55390007310', '00088222033', '00008084199', '58177020211', '00517260225', '58177000111', '00074610204', '00904224461', '00182844789', '00517391025', '00338055318', '00409176230', '00641040025', '00002831501', '00002821501', '00409665305', '61553008348', '00008092355', '00338055002', '00409490234', '00904516561', '00409792337', '51079000220', '00517571025', '00338001704', '00781305714', '00574705050', '00409198530', '00338008504', '00121054410', '00904404073', '51079080120', '49502069724', '00338001731', '00409729501', '10019016312', '10019003867', '00517090125', '64253033335', '63739008901', '00487980125', '00056017275', '00074198530', '00338001703', '00056016975', '63323026965', '00338004304', '00409128331', '54569523500', '55390000401', '00409610204', '00054848616', '08290036005', '00406055262', '00713016550', '00904526161', '00002735501', '00074407532', '00406051262', '63323031110', '00245004101', '58177000104', '00409131230', '63653117103', '00338004931', '00310030011', '10019003783', '17314931102', '00074665305', '00045025501', '00264751020', '00338067104', '60258000601', '00143987310', '51079041720', '00409662502', '00074148402', '00409125830', '00409779362', '00056017075', '62584078833', '63323026920', '63739002401', '00054839224', '00703450204', '00121065721', '00409433201', '10019002710', '00487950125', '00074779362', '63323061603', '00338002304', '17714001110', '00045050130', '00165002241', '00641037625', '51079012620', '63739027201', '00703115303', '00054829725', '66553000401', '00536338101', '00074233411', '51079038620', '51079001920', '10019051002', '60505068104', '00904399061', '00074177825', '00338519741', '00517293025', '00121043130', '00904777261', '66689036430', '51079055271', '67467064301', '00338070948', '55390034810', '10019017644', '00002751001', '00056017675', '55390005710', '00006494300', '00469061711', '50242004413', '00054001820', '00409665106', '00074176230', '00781345295', '00904770418', '00206886202', '00045152510', '51079096620', '00677178110', '51079090620', '00409781124', '00008081401', '17714002001', '00074781124', '00409148402', '00006473900', '10019002803', '67618030011', '00597001314', '00597008717', '00904053061', '00172375810', '00206885216', '00002445385', '00006353750', '00008092303', '00054829925', '00409739172', '', '00093521193', '00071015540', '00045152010', '00338500241', '00074662502', '00310027539', '00024540134', '00088120806', '00338069104', '00045006801', '00310032520', '00406717162', '51079045420', '51079000522', '00074125901', '00003045051', '63323001302', '00182050789', '00009090020', '10432017002', '00944049101', '55390013020', '00904150061', '55390014710', '51079045620', '00172531210', '00300304613', '00074302401', '00548301200', '63323061401', '63323047401', '00173024256', '17270072101', '51079028520', '00074180001', '52959067430', '00173044202', '00054465025', '00074792201', '00054872425', '00472500360', '00034120081', '00054872625', '00008418806', '00085036207', '49502069703', '00074176201', '51079004120', '00074144304', '00409180001', '00409117830', '10019001303', '49502068524', '10019002804', '51079045120', '00409477702', '63323038810', '51079087101', '63323018410', '00074729501', '63323022110', '00517760425', '00054001720', '00338105102', '63323016101', '00074241612', '00074158411', '00517460525', '00182845389', '68094020462', '00264310311', '11098003002', '00338008904', '00071015823', '60505260400', '63323016501', '00338001710', '00074115170', '00182116189', '10019001617', '00338070541', '51079090520', '00338268975', '00517570225', '00172376010', '51079033530', '00904198861', '66591018442', '00409915801', '00409606211', '00087057007', '33332001001', '51991045757', '00904504561', '51079007220', '00469065773', '60977045101', '00409127332', '00206885516', '00182138167', '00045006701', '58177032304', '33332001101', '00071015640', '00904272561', '00074131230', '43825010201', '00406051201', '00182117089', '51079074520', '00409163802', '00548590000', '54868277600', '00074915801', '00182853489', '00310030050', '61553011841', '00069153041', '00172438210', '00338001738', '00002871501', '55390046001', '17478093401', '00064065001', '60505251903', '00009338901', '51079075920', '00338001701', '51079000620', '00310013039', '00007313705', '00172439018', '63481062375']

first_header = []
second_header = []
history_header = []

for i in drugs:
    first_header.append(i+'_first')
    second_header.append(i + '_second')
    history_header.append(i + '_history')



disease_dic = {}
drug_dic = {}
for i in range(len(diseases)):
    disease_dic[diseases[i]] = i
for i in range(len(drugs)):
    drug_dic[drugs[i]] = i
# print(dic)
#
csv_reader = csv.reader(open(r'C:\Users\pinkpigma\pinkpigma的同步盘\KDD研二上\可解释性框架-工作\数据\patient_diagnoses2000_ndc300_with_history.csv', 'r'))
csv_writer = csv.writer(open(r'C:\Users\pinkpigma\pinkpigma的同步盘\KDD研二上\可解释性框架-工作\数据\patient_diagnoses2000_ndc300_with_history_delete2.csv', 'w', newline=''))
count = 0
for line in csv_reader:
    if count == 0:
        header = line[:-4] + diseases + first_header+second_header+history_header
        csv_writer.writerow(header)
        count += 1
        continue
    patient_features = line[3:-4]
    # print(patient_features)
    if patient_features.count('') > 10:
        continue
    current_diseases = line[-4].split(';')
    history_drugs = line[-1].split(';')
    second_drugs = line[-2].split(';')
    if len(second_drugs) < 2 or len(second_drugs)>40:
        continue
    first_drugs = line[-3].split(';')
    if len(first_drugs) < 2 or len(first_drugs)>40:
        continue
    disease_line = [0] * len(diseases)
    history_drugs_line = [0] * len(drugs)
    second_drugs_line = [0] * len(drugs)
    first_drugs_line = [0] * len(drugs)
    for i in current_diseases:
        if i == '':
            continue
        disease_line[disease_dic[i]] = 1
    for i in first_drugs:
        first_drugs_line[drug_dic[i]] = 1
    for i in second_drugs:
        second_drugs_line[drug_dic[i]] = 1
    for i in history_drugs:
        history_drugs_line[drug_dic[i]] = 1
    csv_writer.writerow(line[:-4] + disease_line + first_drugs_line + second_drugs_line + history_drugs_line)
